<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel do Gerente</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='painel_gerente.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body class="painel-gerente">

  <!-- Mensagens flash -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="alert {{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <header class="top-bar">
    <h2>Painel do Gerente: <span>{{ gerente }}</span></h2>
    <p class="saldo">Saldo disponÃ­vel: <strong>R$ {{ creditos }}</strong></p>
  </header>

  <section class="card">
    <h3>ğŸ§¾ Criar novo revendedor</h3>
    <form method="POST" class="form-criar">
      <input type="text" name="usuario" placeholder="Nome do revendedor" required />
      <input type="password" name="senha" placeholder="Senha" required />
      <input type="number" name="creditos" placeholder="CrÃ©ditos iniciais" min="0" required />
      <button type="submit" class="btn btn-criar">Criar</button>
    </form>
  </section>

  <section class="card">
    <h3>ğŸ’¸ Transferir saldo para revendedor</h3>
    <form method="POST" class="form-transferir">
      <input type="text" name="destino" placeholder="Nome do revendedor" required />
      <input type="number" name="valor" placeholder="Valor" min="1" required />
      <button type="submit" class="btn btn-transferir">Transferir</button>
    </form>
  </section>

  <section class="card">
    <h3>ğŸ“‹ Revendedores cadastrados</h3>
    <table class="tabela-revendedores">
      <thead>
        <tr>
          <th>Nome</th>
          <th>CrÃ©ditos</th>
          <th>Tipo</th>
          <th>Criado por</th>
        </tr>
      </thead>
      <tbody>
        {% for nome, dados in revendedores.items() %}
        <tr>
          <td>{{ nome }}</td>
          <td>R$ {{ dados.creditos }}</td>
          <td>{{ dados.tipo }}</td>
          <td>{{ dados.get('criado_por') or dados.get('gerente') or 'admin' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <footer class="acoes">
    <a href="/dashboard" class="btn btn-dashboard">Ir para o Dashboard</a>
    <a href="/logout" class="btn btn-sair">Sair</a>
  </footer>
<script>
  // Remove alertas automaticamente apÃ³s 5 segundos
  setTimeout(() => {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(alert => {
      alert.style.opacity = '0';
      setTimeout(() => alert.remove(), 500); // remove apÃ³s fade-out
    });
  }, 5000);
</script>

</body>
</html>
